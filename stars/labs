Sub PushLab_RelativeToExcel()
    Dim xlPath As String
    Dim repoPath As String
    Dim labFolder As String
    Dim fullLabPath As String
    Dim commitMsg As String
    Dim shellCommand As String
    Dim WshShell As Object

    ' ğŸ“ Get Excel's path
    xlPath = ThisWorkbook.Path

    ' ğŸ§­ Repo base = 3 levels up from this .xlsm location
    ' From ...\bl-tier1-pointer\stars\labs\ to ...\bl-tier1-pointer
    repoPath = xlPath
    repoPath = Left(repoPath, InStrRev(repoPath, "\stars\") - 1)

    ' ğŸ“¦ Read lab name from B2
    labFolder = Range("B2").Value
    fullLabPath = "stars\labs\" & labFolder

    ' ğŸ’¬ Read commit message from B3
    commitMsg = Range("B3").Value
    If commitMsg = "" Then commitMsg = "âš”ï¸ Push " & labFolder

    ' ğŸ§ª Build the Git push command
    shellCommand = "cd /d """ & repoPath & """ && " & _
                   "git add """ & fullLabPath & """ && " & _
                   "git commit -m """ & commitMsg & """ && " & _
                   "git push"

    ' ğŸš€ Fire
    Set WshShell = CreateObject("WScript.Shell")
    WshShell.Run "cmd.exe /c " & shellCommand, 0, True

    MsgBox "âœ… Lab '" & labFolder & "' pushed to GitHub!", vbInformation
End Sub
